{"version":3,"names":["searchFormElement","el","getExperimalMode","devHint","console","log","HTMLElement","tagName","parentElement","parentNode","ShadowRoot","host","propagateResetEventToForm","options","form","event","Event","bubbles","cancelable","setEventTarget","dispatchEvent","KoliBriDevHelper","querySelector","kolForm","_a","_on","onReset","_b","propagateSubmitEventToForm","SubmitEvent","submitter","onSubmit"],"sources":["src/components/form/controller.ts"],"sourcesContent":["import { devHint } from '../../utils/a11y.tipps';\r\nimport { getExperimalMode } from '../../utils/dev.utils';\r\nimport { KoliBriDevHelper, setEventTarget } from '../../utils/prop.validators';\r\nimport { KoliBriFormProps } from './types';\r\n\r\nconst searchFormElement = (el?: HTMLElement | ParentNode | null): HTMLElement | ParentNode | null | undefined => {\r\n\tif (getExperimalMode()) {\r\n\t\tdevHint(`↓ Search form element start.`);\r\n\t\tconsole.log(el);\r\n\t}\r\n\twhile (el instanceof HTMLElement && el.tagName !== 'FORM' && el.tagName !== 'KOL-FORM') {\r\n\t\tif (el.parentElement instanceof HTMLElement) {\r\n\t\t\tel = el.parentElement;\r\n\t\t} else if (el.parentNode instanceof ShadowRoot) {\r\n\t\t\tel = el.parentNode.host;\r\n\t\t} else {\r\n\t\t\tel = null;\r\n\t\t}\r\n\t\tif (getExperimalMode()) {\r\n\t\t\tconsole.log(el);\r\n\t\t}\r\n\t}\r\n\tif (getExperimalMode()) {\r\n\t\tdevHint(`↑ Search form element finished.`);\r\n\t}\r\n\treturn el;\r\n};\r\n\r\nexport const propagateResetEventToForm = (\r\n\toptions: {\r\n\t\tform?: HTMLElement | ParentNode | null;\r\n\t\tref?: HTMLElement;\r\n\t} = {}\r\n): void => {\r\n\tconst form = searchFormElement(options.form);\r\n\tif (form instanceof HTMLElement) {\r\n\t\tconst event = new Event('reset', {\r\n\t\t\tbubbles: true,\r\n\t\t\tcancelable: true,\r\n\t\t});\r\n\t\tif (form.tagName === 'FORM') {\r\n\t\t\tsetEventTarget(event, form);\r\n\t\t\tform.dispatchEvent(event);\r\n\t\t} else if (form.tagName === 'KOL-FORM') {\r\n\t\t\tsetEventTarget(event, KoliBriDevHelper.querySelector('form', form) as HTMLFormElement);\r\n\t\t\tconst kolForm = form as KoliBriFormProps;\r\n\t\t\tif (typeof kolForm._on?.onReset === 'function') {\r\n\t\t\t\ttypeof kolForm._on?.onReset(event);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n\r\nexport const propagateSubmitEventToForm = (\r\n\toptions: {\r\n\t\tform?: HTMLElement | ParentNode | null;\r\n\t\tref?: HTMLElement;\r\n\t} = {}\r\n): void => {\r\n\tconst form = searchFormElement(options.form);\r\n\tif (form instanceof HTMLElement) {\r\n\t\tconst event = new SubmitEvent('submit', {\r\n\t\t\tbubbles: true,\r\n\t\t\tcancelable: true,\r\n\t\t\tsubmitter: form,\r\n\t\t});\r\n\t\t/**\r\n\t\t * TODO: Wenn Formular-Action (nicht Ajax oder JS) verwendet wird,\r\n\t\t * dann müssen wir das Event an das HTMLFormElement innerhalb\r\n\t\t * der HTMLKolFormElements propagieren, wenn kein onSubmit\r\n\t\t * gesetzt wurde.\r\n\t\t *\r\n\t\t * TODO: Form-associated custom elements:\r\n\t\t * - https://web.dev/more-capable-form-controls/\r\n\t\t * - https://github.com/public-ui/kolibri/issues/946\r\n\t\t */\r\n\t\tif (form.tagName === 'FORM') {\r\n\t\t\tsetEventTarget(event, form);\r\n\t\t\tform.dispatchEvent(event);\r\n\t\t} else if (form.tagName === 'KOL-FORM') {\r\n\t\t\tsetEventTarget(event, KoliBriDevHelper.querySelector('form', form) as HTMLFormElement);\r\n\t\t\tconst kolForm = form as KoliBriFormProps;\r\n\t\t\tif (typeof kolForm._on?.onSubmit === 'function') {\r\n\t\t\t\tkolForm._on?.onSubmit(event);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n};\r\n"],"mappings":";;;kJAKA,MAAMA,EAAqBC,IAC1B,GAAIC,IAAoB,CACvBC,EAAQ,gCACRC,QAAQC,IAAIJ,E,CAEb,MAAOA,aAAcK,aAAeL,EAAGM,UAAY,QAAUN,EAAGM,UAAY,WAAY,CACvF,GAAIN,EAAGO,yBAAyBF,YAAa,CAC5CL,EAAKA,EAAGO,a,MACF,GAAIP,EAAGQ,sBAAsBC,WAAY,CAC/CT,EAAKA,EAAGQ,WAAWE,I,KACb,CACNV,EAAK,I,CAEN,GAAIC,IAAoB,CACvBE,QAAQC,IAAIJ,E,EAGd,GAAIC,IAAoB,CACvBC,EAAQ,kC,CAET,OAAOF,CAAE,E,MAGGW,EAA4B,CACxCC,EAGI,M,QAEJ,MAAMC,EAAOd,EAAkBa,EAAQC,MACvC,GAAIA,aAAgBR,YAAa,CAChC,MAAMS,EAAQ,IAAIC,MAAM,QAAS,CAChCC,QAAS,KACTC,WAAY,OAEb,GAAIJ,EAAKP,UAAY,OAAQ,CAC5BY,EAAeJ,EAAOD,GACtBA,EAAKM,cAAcL,E,MACb,GAAID,EAAKP,UAAY,WAAY,CACvCY,EAAeJ,EAAOM,EAAiBC,cAAc,OAAQR,IAC7D,MAAMS,EAAUT,EAChB,WAAWU,EAAAD,EAAQE,OAAG,MAAAD,SAAA,SAAAA,EAAEE,WAAY,WAAY,SACxCC,EAAAJ,EAAQE,OAAG,MAAAE,SAAA,SAAAA,EAAED,QAAQX,G,WAMnBa,EAA6B,CACzCf,EAGI,M,QAEJ,MAAMC,EAAOd,EAAkBa,EAAQC,MACvC,GAAIA,aAAgBR,YAAa,CAChC,MAAMS,EAAQ,IAAIc,YAAY,SAAU,CACvCZ,QAAS,KACTC,WAAY,KACZY,UAAWhB,IAYZ,GAAIA,EAAKP,UAAY,OAAQ,CAC5BY,EAAeJ,EAAOD,GACtBA,EAAKM,cAAcL,E,MACb,GAAID,EAAKP,UAAY,WAAY,CACvCY,EAAeJ,EAAOM,EAAiBC,cAAc,OAAQR,IAC7D,MAAMS,EAAUT,EAChB,WAAWU,EAAAD,EAAQE,OAAG,MAAAD,SAAA,SAAAA,EAAEO,YAAa,WAAY,EAChDJ,EAAAJ,EAAQE,OAAG,MAAAE,SAAA,SAAAA,EAAEI,SAAShB,E"}