/*!
 * KoliBri - The accessible HTML-Standard
 */
var commonjsGlobal="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},loglevel={exports:{}};!function(e){var t,o;t=commonjsGlobal,o=function(){var e=function(){},t="undefined",o=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),n=["trace","debug","info","warn","error"],l={},s=null;function r(e,t){var o=e[t];if("function"==typeof o.bind)return o.bind(e);try{return Function.prototype.bind.call(o,e)}catch(t){return function(){return Function.prototype.apply.apply(o,[e,arguments])}}}function i(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function a(){for(var o=this.getLevel(),l=0;l<n.length;l++){var s=n[l];this[s]=l<o?e:this.methodFactory(s,o,this.name)}if(this.log=this.debug,typeof console===t&&o<this.levels.SILENT)return"No console available for logging"}function c(e){return function(){typeof console!==t&&(a.call(this),this[e].apply(this,arguments))}}function f(n,l,s){return function(n){return"debug"===n&&(n="log"),typeof console!==t&&("trace"===n&&o?i:void 0!==console[n]?r(console,n):void 0!==console.log?r(console,"log"):e)}(n)||c.apply(this,arguments)}function h(e,o){var r,i,c,h=this,y="loglevel";function u(){var e;if(typeof window!==t&&y){try{e=window.localStorage[y]}catch(e){}if(typeof e===t)try{var o=window.document.cookie,n=encodeURIComponent(y),l=o.indexOf(n+"=");-1!==l&&(e=/^([^;]+)/.exec(o.slice(l+n.length+1))[1])}catch(e){}return void 0===h.levels[e]&&(e=void 0),e}}function m(e){var t=e;if("string"==typeof t&&void 0!==h.levels[t.toUpperCase()]&&(t=h.levels[t.toUpperCase()]),"number"==typeof t&&t>=0&&t<=h.levels.SILENT)return t;throw new TypeError("log.setLevel() called with invalid level: "+e)}"string"==typeof e?y+=":"+e:"symbol"==typeof e&&(y=void 0),h.name=e,h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},h.methodFactory=o||f,h.getLevel=function(){return null!=c?c:null!=i?i:r},h.setLevel=function(e,o){return c=m(e),!1!==o&&function(e){var o=(n[e]||"silent").toUpperCase();if(typeof window!==t&&y){try{return void(window.localStorage[y]=o)}catch(e){}try{window.document.cookie=encodeURIComponent(y)+"="+o+";"}catch(e){}}}(c),a.call(h)},h.setDefaultLevel=function(e){i=m(e),u()||h.setLevel(e,!1)},h.resetLevel=function(){c=null,function(){if(typeof window!==t&&y){try{window.localStorage.removeItem(y)}catch(e){}try{window.document.cookie=encodeURIComponent(y)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch(e){}}}(),a.call(h)},h.enableAll=function(e){h.setLevel(h.levels.TRACE,e)},h.disableAll=function(e){h.setLevel(h.levels.SILENT,e)},h.rebuild=function(){if(s!==h&&(r=m(s.getLevel())),a.call(h),s===h)for(var e in l)l[e].rebuild()},r=m(s?s.getLevel():"WARN");var p=u();null!=p&&(c=m(p)),a.call(h)}(s=new h).getLogger=function(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=l[e];return t||(t=l[e]=new h(e,s.methodFactory)),t};var y=typeof window!==t?window.log:void 0;return s.noConflict=function(){return typeof window!==t&&window.log===s&&(window.log=y),s},s.getLoggers=function(){return l},s.default=s,s},e.exports?e.exports=o():t.log=o()}(loglevel);const f=loglevel.exports,o={};let u=!0,A=!1;const D=/^[a-z][a-z0-9]{1,}(-[a-z0-9]+)?$/,I=e=>"string"==typeof e&&D.test(e),g=e=>{if(!1===I(e))throw new Error(`[Theming] The theme identifier "${"string"==typeof e?e:""}" (Type: ${typeof e}) is not valid. Please use only follow this pattern: /^[a-z][a-z0-9]{1,}(-[a-z0-9]+)?$/`)},b=(e,t,n,l)=>{(l=l??{}).append=l.append??!1,g(e),!0===u&&!1===A&&(A=!0,f.warn(`[Theming] The theme process is locked. This means that the theme "${e}" should not be patched.\n\n\timport { register } from 'adopted-style-sheets';\n\timport { defineCustomElements } from '...';\n\timport { THEME } from '...';\n\n\tregister(THEME, defineCustomElements)\n\t.then(() => {\n\t\t// run your app or website\n\t})\n\t.catch(console.warn);`)),("object"!=typeof o.A11yUi||null===o.A11yUi)&&(o.A11yUi={}),"object"==typeof o.A11yUi&&null!==o.A11yUi&&("object"!=typeof o.A11yUi.Themes||null===o.A11yUi.Themes)&&(o.A11yUi.Themes={}),"object"==typeof o.A11yUi&&null!==o.A11yUi&&"object"==typeof o.A11yUi.Themes&&null!==o.A11yUi.Themes&&("object"!=typeof o.A11yUi.Themes[e]||null===o.A11yUi.Themes[e])&&(o.A11yUi.Themes[e]={}),"object"==typeof o.A11yUi&&null!==o.A11yUi&&"object"==typeof o.A11yUi.Themes&&null!==o.A11yUi.Themes&&"object"==typeof o.A11yUi.Themes[e]&&null!==o.A11yUi.Themes[e]&&(l.append&&"string"==typeof o.A11yUi.Themes[e][t]?o.A11yUi.Themes[e][t]+=n:o.A11yUi.Themes[e][t]=n)},U=(e,t,o,n)=>(g(e),"object"==typeof t&&null!==t&&Object.getOwnPropertyNames(t).forEach((l=>{const s=t[l],r=l.toLowerCase(),i="function"!=typeof n?.transformTagName||["GLOBAL","PROPERTIES"].includes(l)?l:n.transformTagName(r);"string"==typeof s&&s.length>0&&b(e,i.toUpperCase(),s,o)})),e),E=e=>{if(e instanceof HTMLElement){if("string"==typeof e.dataset.theme)return e;{let t=e.parentNode;for(;t instanceof ShadowRoot;)t=t.host;return E(t)}}return null},S=(e={})=>"false"!==e.themeEncroachCss&&"true"!==e.themeReset&&{mode:"after"===e.themeEncroachCssMode||"before"===e.themeEncroachCssMode?e.themeEncroachCssMode:"before"},w=()=>"object"==typeof o.A11yUi&&null!==o.A11yUi&&"object"==typeof o.A11yUi.Theme&&null!==o.A11yUi.Theme&&"boolean"==typeof o.A11yUi.Theme.cache&&"object"==typeof o.A11yUi.Theme.encroachCss&&null!==o.A11yUi.Theme.encroachCss&&"string"==typeof o.A11yUi.Theme.encroachCss.mode&&"string"==typeof o.A11yUi.Theme.name,z=()=>!("object"==typeof o.A11yUi&&null!==o.A11yUi&&"object"==typeof o.A11yUi.Theme&&null!==o.A11yUi.Theme&&"default"===o.A11yUi.Theme.name),j=e=>{if(w())return o.A11yUi.Theme;{const t={cache:!0,encroachCss:S(),loglevel:"silent",name:null},o=E(e);return o instanceof HTMLElement&&(t.cache="false"!==o.dataset.themeCache,t.encroachCss=S(o.dataset),t.loglevel="debug"===o.dataset.themeLoglevel?o.dataset.themeLoglevel:"silent",t.name=o.dataset.theme||null),t}},k=(e,t)=>({cache:!1!==t.cache,detect:"auto"===t.detect?"auto":"fixed",encroachCss:!1!==t.encroachCss&&("object"!=typeof t.encroachCss||null==t.encroachCss||"after"!==t.encroachCss.mode&&"before"!==t.encroachCss.mode?{mode:"before"}:t.encroachCss),loglevel:"debug"===t.loglevel?t.loglevel:"silent",name:"string"==typeof t.name?t.name:e}),Y=(e,t)=>{!1===w()&&z()&&"object"==typeof t&&null!==t&&("fixed"===(t=k(e,t)).detect?(null===t.name&&"string"==typeof e&&(t.name=e),e===t.name&&(("object"!=typeof o.A11yUi||null===o.A11yUi)&&(o.A11yUi={}),o.A11yUi.Theme=t,f.info(`[Theming] Theme "${e}" was set as default theme.`))):f.warn("[Theming] The presetting of theme options is only relevant by using 'fixed' detection mode."))};let C=!1;const _=(e,t,o={})=>{!1===C&&(C=!0,u=!1),"function"==typeof e?e=new Set([e]):Array.isArray(e)&&(e=new Set(e)),e instanceof Set&&e.forEach((e=>{"function"==typeof e&&1===e.length?Y(e(((e,t,n)=>U(e,t,n,o))),{cache:o.theme?.cache,detect:o.theme?.detect,encroachCss:o.theme?.encroachCss,name:o.theme?.name}):f.error("[Theming] Es wurde versucht eine nicht kompatibles Theme zu laden.")})),u=!0,"function"==typeof t?t=new Set([t]):Array.isArray(t)&&(t=new Set(t));const n=[];return t.forEach((e=>{const t=e();t instanceof Promise&&n.push(t)})),Promise.all(n)},c=new Map,v=[],L=new Set,h=new Map,B=/--[^;]+/g,G=/:/;("object"!=typeof o.A11yUi||null===o.A11yUi)&&(o.A11yUi={CSS_STYLE_CACHE:h,HYDRATED_HISTORY:v,STYLING_TASK_QUEUE:c});const K=(e,t)=>{let o=t.match(B);if(Array.isArray(o)){o=o.filter((e=>G.test(e)));const t=document.createElement("style");t.innerHTML=`.${e} {${o.join(";")}}`,document.querySelector("head")?.appendChild(t)}L.add(e)},T=(e,t)=>"object"==typeof o.A11yUi&&null!==o.A11yUi&&"object"==typeof o.A11yUi.Themes&&null!==o.A11yUi.Themes&&"object"==typeof o.A11yUi.Themes[e]&&null!==o.A11yUi.Themes[e]&&"string"==typeof o.A11yUi.Themes[e][t]?o.A11yUi.Themes[e][t].replace(/\r?\n/g,""):"",q=e=>{for(const t of Array.from(e.childNodes)){if(!(t instanceof HTMLStyleElement&&"STYLE"===t.tagName))break;e.removeChild(t)}},F=(e,t)=>{try{const o=[];t.forEach((e=>{const t=new CSSStyleSheet;t.replaceSync(e),o.push(t)})),e.adoptedStyleSheets=o}catch{t.reverse().forEach((t=>{const o=document.createElement("style");o.innerHTML=t,e.insertBefore(o,e.firstChild)}))}},Q=(e,t,o)=>{if(!1!==o){const n=[...Array.from(e.childNodes).filter((e=>e instanceof HTMLStyleElement&&"STYLE"===e.tagName))];let l;try{l=[...Array.from(e.adoptedStyleSheets)]}catch{l=[]}"before"===o?.mode?(n.reverse().forEach((e=>t.unshift(e.innerHTML))),l.reverse().forEach((e=>t.unshift(Array.from(e.cssRules).map((e=>e.cssText)).join(""))))):"after"===o?.mode&&(n.forEach((e=>t.push(e.innerHTML))),l.forEach((e=>t.push(Array.from(e.cssRules).map((e=>e.cssText)).join("")))))}},M=(e,t,o)=>{const n=t.name||"default";let l;try{if(null===e.shadowRoot)throw new Error("ShadowRoot is null");l=e.shadowRoot}catch{l=e}if(h.get(n)?.has(e.tagName))$(e,l,h.get(n)?.get(e.tagName),o);else{const s=T(n,"PROPERTIES"),r=T(n,"GLOBAL"),i=T(n,e.tagName);!1===L.has(n)&&K(n,r);const a=[s,r,i];Q(l,a,t.encroachCss),"debug"===t.loglevel&&console.log(e.tagName,a),!0===t.cache&&(!1===h.has(n)&&h.set(n,new Map),h.get(n)?.set(e.tagName,a)),$(e,l,a,o)}},$=(e,t,o,n)=>{q(t),F(t,o),e.style.display=n},O=e=>{"debug"===e.loglevel&&v.push({timestamp:Date.now(),numberOfTasks:c.size})},J=(e,t)=>{c.set(e,{styleDisplay:e.style.display?`${e.style.display}`:null,themeDetails:t})},V=(e,t)=>{J(e,t),O(t)},W=e=>{c.delete(e)},R=(e,t)=>{W(e),O(t)},N=e=>{const t=setTimeout((()=>{if(clearTimeout(t),c.has(e)&&e.classList.contains("hydrated")){const{styleDisplay:t,themeDetails:o}=c.get(e);M(e,o,t),R(e,o)}else N(e)}),25)},X=e=>{for(const t of e)if(c.has(t.target)&&t.target.classList.contains("hydrated")){const{styleDisplay:e,themeDetails:o}=c.get(t.target);M(t.target,o,e),R(t.target,o)}},Z={attributes:!0,attributeFilter:["class"],childList:!1,subtree:!1};let p;try{p=new MutationObserver(X)}catch{p=null}const ee=(e,t)=>{V(e,t),p?p.observe(e,Z):N(e),e.style.display="none"};export{U,_,b,ee as e,j};