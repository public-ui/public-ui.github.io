"use strict";(self.webpackChunkroot=self.webpackChunkroot||[]).push([[5455],{64160:(e,t,s)=>{s.d(t,{c:()=>i});var r=s(71180),o=s(85811);const n=function(e){return(0,o.Z)(e,4)};var a=s(55247);s(99965);function i(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:d(e),edges:c(e)};return r.Z(e.graph())||(t.value=n(e.graph())),t}function d(e){return a.Z(e.nodes(),(function(t){var s=e.node(t),o=e.parent(t),n={v:t};return r.Z(s)||(n.value=s),r.Z(o)||(n.parent=o),n}))}function c(e){return a.Z(e.edges(),(function(t){var s=e.edge(t),o={v:t.v,w:t.w};return r.Z(t.name)||(o.name=t.name),r.Z(s)||(o.value=s),o}))}},25455:(e,t,s)=>{s.r(t),s.d(t,{diagram:()=>N});var r=s(76172),o=s(39564),n=s(63321),a=s(94214),i=s(58811),d=s(96026),c=s(32233);s(33582),s(75696),s(24963),s(64160),s(85804);const l="rect",p="rectWithTitle",g="statediagram",u=`${g}-state`,b="transition",h=`${b} note-edge`,y=`${g}-note`,f=`${g}-cluster`,m=`${g}-cluster-alt`,w="parent",x="note",v="----",$=`${v}${x}`,T=`${v}${w}`,S="fill:none",k="fill: #333",D="text",A="normal";let B={},Z=0;function C(e="",t=0,s="",r=v){return`state-${e}${null!==s&&s.length>0?`${r}${s}`:""}-${t}`}const E=(e,t,s,o,n,i)=>{const d=s.id,c=null==(g=o[d])?"":g.classes?g.classes.join(" "):"";var g;if("root"!==d){let t=l;!0===s.start&&(t="start"),!1===s.start&&(t="end"),s.type!==r.a&&(t=s.type),B[d]||(B[d]={id:d,shape:t,description:a.d.sanitizeText(d,(0,a.g)()),classes:`${c} ${u}`});const o=B[d];s.description&&(Array.isArray(o.description)?(o.shape=p,o.description.push(s.description)):o.description.length>0?(o.shape=p,o.description===d?o.description=[s.description]:o.description=[o.description,s.description]):(o.shape=l,o.description=s.description),o.description=a.d.sanitizeTextOrArray(o.description,(0,a.g)())),1===o.description.length&&o.shape===p&&(o.shape=l),!o.type&&s.doc&&(a.l.info("Setting cluster for ",d,V(s)),o.type="group",o.dir=V(s),o.shape=s.type===r.b?"divider":"roundedWithTitle",o.classes=o.classes+" "+f+" "+(i?m:""));const n={labelStyle:"",shape:o.shape,labelText:o.description,classes:o.classes,style:"",id:d,dir:o.dir,domId:C(d,Z),type:o.type,padding:15};if(s.note){const t={labelStyle:"",shape:"note",labelText:s.note.text,classes:y,style:"",id:d+$+"-"+Z,domId:C(d,Z,x),type:o.type,padding:15},r={labelStyle:"",shape:"noteGroup",labelText:s.note.text,classes:o.classes,style:"",id:d+T,domId:C(d,Z,w),type:"group",padding:0};Z++;const a=d+T;e.setNode(a,r),e.setNode(t.id,t),e.setNode(d,n),e.setParent(d,a),e.setParent(t.id,a);let i=d,c=t.id;"left of"===s.note.position&&(i=t.id,c=d),e.setEdge(i,c,{arrowhead:"none",arrowType:"",style:S,labelStyle:"",classes:h,arrowheadStyle:k,labelpos:"c",labelType:D,thickness:A})}else e.setNode(d,n)}t&&"root"!==t.id&&(a.l.trace("Setting node ",d," to be child of its parent ",t.id),e.setParent(d,t.id)),s.doc&&(a.l.trace("Adding nodes children "),R(e,s,s.doc,o,n,!i))},R=(e,t,s,o,n,i)=>{a.l.trace("items",s),s.forEach((s=>{switch(s.stmt){case r.c:case r.a:E(e,t,s,o,n,i);break;case r.S:{E(e,t,s.state1,o,n,i),E(e,t,s.state2,o,n,i);const r={id:"edge"+Z,arrowhead:"normal",arrowTypeEnd:"arrow_barb",style:S,labelStyle:"",label:a.d.sanitizeText(s.description,(0,a.g)()),arrowheadStyle:k,labelpos:"c",labelType:D,thickness:A,classes:b};e.setEdge(s.state1.id,s.state2.id,r,Z),Z++}}}))},V=(e,t=r.e)=>{let s=t;if(e.doc)for(let r=0;r<e.doc.length;r++){const t=e.doc[r];"dir"===t.stmt&&(s=t.value)}return s},M={setConf:function(e){const t=Object.keys(e);for(const s of t)e[s]},getClasses:function(e,t){a.l.trace("Extracting classes"),t.db.clear();try{return t.parser.parse(e),t.db.extract(t.db.getRootDocV2()),t.db.getClasses()}catch(s){return s}},draw:function(e,t,s,p){a.l.info("Drawing state diagram (v2)",t),B={};let u=p.db.getDirection();void 0===u&&(u=r.D);const{securityLevel:b,state:h}=(0,a.g)(),y=h.nodeSpacing||50,f=h.rankSpacing||50;a.l.info(p.db.getRootDocV2()),p.db.extract(p.db.getRootDocV2()),a.l.info(p.db.getRootDocV2());const m=p.db.getStates(),w=new o.k({multigraph:!0,compound:!0}).setGraph({rankdir:V(p.db.getRootDocV2()),nodesep:y,ranksep:f,marginx:8,marginy:8}).setDefaultEdgeLabel((function(){return{}}));let x;E(w,void 0,p.db.getRootDocV2(),m,p.db,!0),"sandbox"===b&&(x=(0,n.Ys)("#i"+t));const v="sandbox"===b?(0,n.Ys)(x.nodes()[0].contentDocument.body):(0,n.Ys)("body"),$=v.select(`[id="${t}"]`),T=v.select("#"+t+" g");(0,i.r)(T,w,["barb"],g,t);c.u.insertTitle($,"statediagramTitleText",h.titleTopMargin,p.db.getDiagramTitle());const S=$.node().getBBox(),k=S.width+16,D=S.height+16;$.attr("class",g);const A=$.node().getBBox();(0,d.c)($,D,k,h.useMaxWidth);const Z=`${A.x-8} ${A.y-8} ${k} ${D}`;a.l.debug(`viewBox ${Z}`),$.attr("viewBox",Z);const C=document.querySelectorAll('[id="'+t+'"] .edgeLabel .label');for(const r of C){const e=r.getBBox(),t=document.createElementNS("http://www.w3.org/2000/svg",l);t.setAttribute("rx",0),t.setAttribute("ry",0),t.setAttribute("width",e.width),t.setAttribute("height",e.height),r.insertBefore(t,r.firstChild)}}},N={parser:r.p,db:r.d,renderer:M,styles:r.s,init:e=>{e.state||(e.state={}),e.state.arrowMarkerAbsolute=e.arrowMarkerAbsolute,r.d.clear()}}}}]);