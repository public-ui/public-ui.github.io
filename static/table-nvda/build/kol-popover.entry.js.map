{"version":3,"names":["validateAlign","component","value","watchString","styleCss","KolPopover","this","alignPopover","callBack","setTimeout","processEnv","triggerElement","popoverElement","trigger","popoverEl","arrowEl","arrowElement","middleware","offset","_a","offsetHeight","flip","shift","push","arrow","element","computePosition","placement","state","_align","then","x","y","middlewareData","setPosition","showPopover","addListenersToBody","Object","assign","_visible","hidePopoverByEscape","event","key","hidePopover","hidePopoverByClickOutside","host","contains","target","catchHostAndTriggerElement","previousElementSibling","catchPopoverElement","catchArrowElement","_show","oldPos","left","style","top","inset","translate","focus","removeListenersToBody","body","getDocument","addEventListener","document","scrollingElement","passive","removeEventListener","render","h","Host","ref","class","popover","hidden","show","validateShow","componentWillLoad"],"sources":["src/types/props/align.ts","src/components/popover/style.css?tag=kol-popover","src/components/popover/component.tsx"],"sourcesContent":["import { Generic } from '@a11y-ui/core';\r\n\r\nimport { watchString } from '../../utils/prop.validators';\r\n\r\n/* types */\r\n/** de\r\n * Markiert das Element als ausgewÃ¤hltes/aktiviertes. Kann folgende Werte annehmen: `date` | `location` | `page` | `step` | `time` | `true`.\r\n *  (https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-current)\r\n */\r\n\r\n/** en\r\n * Marks the element as the selected in a group of related elements. Can be one of the following: `date` | `location` | `page` | `step` | `time` | `true`.\r\n *  (https://developer.mozilla.org/en-US/docs/Web/Accessibility/ARIA/Attributes/aria-current)\r\n */\r\ntype HorizontalAlign = 'left' | 'right';\r\ntype VerticalAlign = 'top' | 'bottom';\r\nexport type Align = HorizontalAlign | VerticalAlign;\r\nexport type PropAlign = {\r\n\talign: Align;\r\n};\r\n\r\n/* validator */\r\nexport const validateAlign = (component: Generic.Element.Component, value?: Align): void => {\r\n\twatchString(component, '_align', value);\r\n};\r\n","@import url(../style.css);\nkol-popover {\n\theight: 0;\n\tposition: absolute;\n}\nkol-popover .popover {\n\tbackground-color: #fff;\n\tmin-height: max-content;\n\tmin-width: max-content;\n\topacity: 0;\n\tposition: absolute;\n}\nkol-popover .hidden {\n\tdisplay: none;\n}\nkol-popover .show {\n\tanimation: 0.3s ease-in forwards fadeInOpacity;\n}\nkol-popover .disappear {\n\tanimation: 0.3s ease-in backwards fadeInOpacity;\n}\nkol-popover .arrow {\n\tbackground-color: inherit;\n\theight: var(--font-size);\n\tposition: absolute;\n\trotate: 0.125turn;\n\twidth: var(--font-size);\n\tz-index: -1;\n}\n@keyframes fadeInOpacity {\n\t0% {\n\t\topacity: 0;\n\t}\n\t100% {\n\t\topacity: 1;\n\t}\n}\n","import { arrow, computePosition, flip, MiddlewareData, offset, Placement, shift } from '@floating-ui/dom';\r\nimport { Component, h, Host, JSX, Prop, State, Watch } from '@stencil/core';\r\n\r\nimport { Align, validateAlign } from '../../types/props/align';\r\nimport { validateShow } from '../../types/props/show';\r\nimport { getDocument } from '../../utils/dev.utils';\r\nimport { processEnv } from '../../utils/reuse';\r\nimport { KoliBriPopoverAPI, KoliBriPopoverStates } from './types';\r\n\r\n/**\r\n * @slot - Der Inhalt des Popover.\r\n */\r\n@Component({\r\n\ttag: 'kol-popover',\r\n\tstyleUrl: './style.css',\r\n\tshadow: false,\r\n})\r\nexport class KolPopover implements KoliBriPopoverAPI {\r\n\tprivate arrowElement?: HTMLDivElement;\r\n\tprivate popoverElement?: HTMLDivElement;\r\n\tprivate triggerElement?: HTMLElement | null;\r\n\tprivate host?: HTMLElement;\r\n\r\n\t/* Popover functions */\r\n\tprivate alignPopover = (callBack?: () => unknown): void => {\r\n\t\tsetTimeout(() => {\r\n\t\t\tif (processEnv !== 'test' && this.triggerElement && this.popoverElement) {\r\n\t\t\t\tconst trigger = this.triggerElement;\r\n\t\t\t\tconst popoverEl = this.popoverElement;\r\n\t\t\t\tconst arrowEl = this.arrowElement;\r\n\r\n\t\t\t\tconst middleware = [offset(arrowEl?.offsetHeight ?? 10), flip(), shift()];\r\n\t\t\t\tif (arrowEl) {\r\n\t\t\t\t\tmiddleware.push(arrow({ element: arrowEl }));\r\n\t\t\t\t}\r\n\r\n\t\t\t\tvoid computePosition(trigger, popoverEl, {\r\n\t\t\t\t\tplacement: this.state._align,\r\n\t\t\t\t\tmiddleware: middleware,\r\n\t\t\t\t}).then(({ x, y, middlewareData, placement }) => {\r\n\t\t\t\t\tthis.setPosition(x, y, middlewareData, placement, callBack);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\tprivate setPosition(x: number, y: number, middlewareData: MiddlewareData, placement: Placement, callBack?: () => unknown) {\r\n\t\tif (this.popoverElement) {\r\n\t\t\tconst oldPos = {\r\n\t\t\t\tleft: this.popoverElement.style.left,\r\n\t\t\t\ttop: this.popoverElement.style.top,\r\n\t\t\t};\r\n\t\t\tObject.assign(this.popoverElement.style, {\r\n\t\t\t\tleft: `${x}px`,\r\n\t\t\t\ttop: `${y}px`,\r\n\t\t\t});\r\n\r\n\t\t\tif (this.arrowElement && middlewareData.arrow) {\r\n\t\t\t\tswitch (placement) {\r\n\t\t\t\t\tcase 'top':\r\n\t\t\t\t\t\tthis.arrowElement.style.inset = `100% auto auto ${middlewareData.arrow.x || 0}px`;\r\n\t\t\t\t\t\tthis.arrowElement.style.translate = '0 -50%';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'right':\r\n\t\t\t\t\t\tthis.arrowElement.style.inset = `${middlewareData.arrow.y || 0}px 100% auto auto`;\r\n\t\t\t\t\t\tthis.arrowElement.style.translate = '50% 0';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'bottom':\r\n\t\t\t\t\t\tthis.arrowElement.style.inset = `auto auto 100% ${middlewareData.arrow.x || 0}px`;\r\n\t\t\t\t\t\tthis.arrowElement.style.translate = '0 50%';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase 'left':\r\n\t\t\t\t\t\tthis.arrowElement.style.inset = `${middlewareData.arrow.y || 0}px auto auto 100%`;\r\n\t\t\t\t\t\tthis.arrowElement.style.translate = '-50% 0';\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tif (oldPos.left !== this.popoverElement.style.left || oldPos.top !== this.popoverElement.style.top) {\r\n\t\t\t\tthis.alignPopover(callBack);\r\n\t\t\t} else if (typeof callBack === 'function') {\r\n\t\t\t\tcallBack();\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\tprivate showPopover = (): void => {\r\n\t\tthis.addListenersToBody();\r\n\r\n\t\tthis.alignPopover(() => {\r\n\t\t\tthis.state = { ...this.state, _visible: true };\r\n\t\t});\r\n\t};\r\n\tprivate hidePopover(): void {\r\n\t\tthis.state = {\r\n\t\t\t...this.state,\r\n\t\t\t_visible: false,\r\n\t\t};\r\n\t\tthis._show = false;\r\n\t\tthis.triggerElement?.focus();\r\n\t\tthis.removeListenersToBody();\r\n\t}\r\n\tprivate hidePopoverByEscape = (event: KeyboardEvent): void => {\r\n\t\tif (event.key === 'Escape') this.hidePopover();\r\n\t};\r\n\tprivate hidePopoverByClickOutside = (event: MouseEvent): void => {\r\n\t\tif (this.host && !this.host.contains(event.target as HTMLElement)) {\r\n\t\t\tthis.hidePopover();\r\n\t\t}\r\n\t};\r\n\r\n\t/* EventListener functions */\r\n\tprivate addListenersToBody(): void {\r\n\t\tconst body = getDocument().body;\r\n\t\tbody.addEventListener('keyup', this.hidePopoverByEscape);\r\n\t\tbody.addEventListener('click', this.hidePopoverByClickOutside);\r\n\t\tdocument.scrollingElement?.addEventListener('scroll', this.showPopover, { passive: true });\r\n\t}\r\n\tprivate removeListenersToBody(): void {\r\n\t\tconst body = getDocument().body;\r\n\t\tbody.removeEventListener('keyup', this.hidePopoverByEscape);\r\n\t\tbody.removeEventListener('click', this.hidePopoverByClickOutside);\r\n\t\tdocument.scrollingElement?.removeEventListener('scroll', this.showPopover);\r\n\t}\r\n\r\n\t/* catchElement functions */\r\n\tprivate catchHostAndTriggerElement = (element: HTMLElement | null): void => {\r\n\t\tif (element) {\r\n\t\t\tthis.host = element;\r\n\t\t\tthis.triggerElement = element.previousElementSibling as HTMLElement | null;\r\n\t\t}\r\n\t};\r\n\tprivate catchPopoverElement = (element?: HTMLDivElement): void => {\r\n\t\tthis.popoverElement = element;\r\n\t};\r\n\tprivate catchArrowElement = (element?: HTMLDivElement): void => {\r\n\t\tthis.arrowElement = element;\r\n\t};\r\n\r\n\tpublic render(): JSX.Element {\r\n\t\treturn (\r\n\t\t\t<Host ref={this.catchHostAndTriggerElement}>\r\n\t\t\t\t<div class={{ popover: true, hidden: !this.state._show, show: this.state._visible }} ref={this.catchPopoverElement}>\r\n\t\t\t\t\t<div class={`arrow ${this.state._align}`} ref={this.catchArrowElement} />\r\n\t\t\t\t\t<slot />\r\n\t\t\t\t</div>\r\n\t\t\t</Host>\r\n\t\t);\r\n\t}\r\n\r\n\t/**\r\n\t * Setzt die Ausrichtung des Popovers in Relation zum Triggerelement.\r\n\t */\r\n\t@Prop() public _align?: Align = 'top';\r\n\r\n\t/**\r\n\t * Gibt an, ob die Komponente entweder ein- oder ausgeblendet ist.\r\n\t */\r\n\t@Prop({ mutable: true, reflect: true }) public _show?: boolean = false;\r\n\r\n\t@State() public state: KoliBriPopoverStates = {\r\n\t\t_align: 'top',\r\n\t\t_show: false,\r\n\t\t_visible: false,\r\n\t};\r\n\r\n\t@Watch('_align')\r\n\tpublic validateAlign(value?: Align): void {\r\n\t\tvalidateAlign(this, value);\r\n\t}\r\n\r\n\t@Watch('_show')\r\n\tpublic validateShow(value?: boolean): void {\r\n\t\tvalidateShow(this, value);\r\n\t\tif (value) this.showPopover();\r\n\t}\r\n\r\n\tpublic componentWillLoad(): void {\r\n\t\tthis.validateAlign(this._align);\r\n\t\tthis.validateShow(this._show);\r\n\t}\r\n}\r\n"],"mappings":";;;kXAsBO,MAAMA,EAAgB,CAACC,EAAsCC,KACnEC,EAAYF,EAAW,SAAUC,EAAM,ECvBxC,MAAME,EAAW,wrC,MCiBJC,EAAU,M,yBAOdC,KAAAC,aAAgBC,IACvBC,YAAW,K,MACV,GAAIC,IAAe,QAAUJ,KAAKK,gBAAkBL,KAAKM,eAAgB,CACxE,MAAMC,EAAUP,KAAKK,eACrB,MAAMG,EAAYR,KAAKM,eACvB,MAAMG,EAAUT,KAAKU,aAErB,MAAMC,EAAa,CAACC,GAAOC,EAAAJ,IAAO,MAAPA,SAAO,SAAPA,EAASK,gBAAY,MAAAD,SAAA,EAAAA,EAAI,IAAKE,IAAQC,KACjE,GAAIP,EAAS,CACZE,EAAWM,KAAKC,EAAM,CAAEC,QAASV,I,MAG7BW,EAAgBb,EAASC,EAAW,CACxCa,UAAWrB,KAAKsB,MAAMC,OACtBZ,WAAYA,IACVa,MAAK,EAAGC,IAAGC,IAAGC,iBAAgBN,gBAChCrB,KAAK4B,YAAYH,EAAGC,EAAGC,EAAgBN,EAAWnB,EAAS,G,IAG5D,EAwCKF,KAAA6B,YAAc,KACrB7B,KAAK8B,qBAEL9B,KAAKC,cAAa,KACjBD,KAAKsB,MAAKS,OAAAC,OAAAD,OAAAC,OAAA,GAAQhC,KAAKsB,OAAK,CAAEW,SAAU,MAAM,GAC7C,EAWKjC,KAAAkC,oBAAuBC,IAC9B,GAAIA,EAAMC,MAAQ,SAAUpC,KAAKqC,aAAa,EAEvCrC,KAAAsC,0BAA6BH,IACpC,GAAInC,KAAKuC,OAASvC,KAAKuC,KAAKC,SAASL,EAAMM,QAAwB,CAClEzC,KAAKqC,a,GAmBCrC,KAAA0C,2BAA8BvB,IACrC,GAAIA,EAAS,CACZnB,KAAKuC,KAAOpB,EACZnB,KAAKK,eAAiBc,EAAQwB,sB,GAGxB3C,KAAA4C,oBAAuBzB,IAC9BnB,KAAKM,eAAiBa,CAAO,EAEtBnB,KAAA6C,kBAAqB1B,IAC5BnB,KAAKU,aAAeS,CAAO,E,YAiBI,M,WAKiC,M,WAEnB,CAC7CI,OAAQ,MACRuB,MAAO,MACPb,SAAU,M,CAnHHL,YAAYH,EAAWC,EAAWC,EAAgCN,EAAsBnB,GAC/F,GAAIF,KAAKM,eAAgB,CACxB,MAAMyC,EAAS,CACdC,KAAMhD,KAAKM,eAAe2C,MAAMD,KAChCE,IAAKlD,KAAKM,eAAe2C,MAAMC,KAEhCnB,OAAOC,OAAOhC,KAAKM,eAAe2C,MAAO,CACxCD,KAAM,GAAGvB,MACTyB,IAAK,GAAGxB,QAGT,GAAI1B,KAAKU,cAAgBiB,EAAeT,MAAO,CAC9C,OAAQG,GACP,IAAK,MACJrB,KAAKU,aAAauC,MAAME,MAAQ,kBAAkBxB,EAAeT,MAAMO,GAAK,MAC5EzB,KAAKU,aAAauC,MAAMG,UAAY,SACpC,MACD,IAAK,QACJpD,KAAKU,aAAauC,MAAME,MAAQ,GAAGxB,EAAeT,MAAMQ,GAAK,qBAC7D1B,KAAKU,aAAauC,MAAMG,UAAY,QACpC,MACD,IAAK,SACJpD,KAAKU,aAAauC,MAAME,MAAQ,kBAAkBxB,EAAeT,MAAMO,GAAK,MAC5EzB,KAAKU,aAAauC,MAAMG,UAAY,QACpC,MACD,IAAK,OACJpD,KAAKU,aAAauC,MAAME,MAAQ,GAAGxB,EAAeT,MAAMQ,GAAK,qBAC7D1B,KAAKU,aAAauC,MAAMG,UAAY,SACpC,M,CAGH,GAAIL,EAAOC,OAAShD,KAAKM,eAAe2C,MAAMD,MAAQD,EAAOG,MAAQlD,KAAKM,eAAe2C,MAAMC,IAAK,CACnGlD,KAAKC,aAAaC,E,MACZ,UAAWA,IAAa,WAAY,CAC1CA,G,GAWKmC,c,MACPrC,KAAKsB,MAAKS,OAAAC,OAAAD,OAAAC,OAAA,GACNhC,KAAKsB,OAAK,CACbW,SAAU,QAEXjC,KAAK8C,MAAQ,OACbjC,EAAAb,KAAKK,kBAAc,MAAAQ,SAAA,SAAAA,EAAEwC,QACrBrD,KAAKsD,uB,CAYExB,qB,MACP,MAAMyB,EAAOC,IAAcD,KAC3BA,EAAKE,iBAAiB,QAASzD,KAAKkC,qBACpCqB,EAAKE,iBAAiB,QAASzD,KAAKsC,4BACpCzB,EAAA6C,SAASC,oBAAgB,MAAA9C,SAAA,SAAAA,EAAE4C,iBAAiB,SAAUzD,KAAK6B,YAAa,CAAE+B,QAAS,M,CAE5EN,wB,MACP,MAAMC,EAAOC,IAAcD,KAC3BA,EAAKM,oBAAoB,QAAS7D,KAAKkC,qBACvCqB,EAAKM,oBAAoB,QAAS7D,KAAKsC,4BACvCzB,EAAA6C,SAASC,oBAAgB,MAAA9C,SAAA,SAAAA,EAAEgD,oBAAoB,SAAU7D,KAAK6B,Y,CAiBxDiC,SACN,OACCC,EAACC,EAAI,CAACC,IAAKjE,KAAK0C,4BACfqB,EAAA,OAAKG,MAAO,CAAEC,QAAS,KAAMC,QAASpE,KAAKsB,MAAMwB,MAAOuB,KAAMrE,KAAKsB,MAAMW,UAAYgC,IAAKjE,KAAK4C,qBAC9FmB,EAAA,OAAKG,MAAO,SAASlE,KAAKsB,MAAMC,SAAU0C,IAAKjE,KAAK6C,oBACpDkB,EAAA,c,CAuBGrE,cAAcE,GACpBF,EAAcM,KAAMJ,E,CAId0E,aAAa1E,GACnB0E,EAAatE,KAAMJ,GACnB,GAAIA,EAAOI,KAAK6B,a,CAGV0C,oBACNvE,KAAKN,cAAcM,KAAKuB,QACxBvB,KAAKsE,aAAatE,KAAK8C,M"}