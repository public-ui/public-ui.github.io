{"version":3,"names":["validateRequired","component","value","watchBoolean","fillKeyOptionMap","keyOptionMap","options","preKey","forEach","option","index","key","label","length","Array","isArray","set","InputCheckboxRadioController","InputController","constructor","name","host","super","this","componentWillLoad","_required","InputRadioController","Map","getOptionByKey","get","isValueInOptions","find","undefined","beforePatchListValue","_value","nextState","list","has","state","_list","clear","newValue","onStateChange","validateOrientation","watchValidator","Set","defaultValue","validateList","watchJsonArrayString","item","hooks","beforePatch","validateValue","mapString2Unknown","setState","setFormAssociatedValue","onChange","timeout","setTimeout","clearTimeout","STATE_CHANGE_EVENT","_orientation"],"sources":["src/types/props/required.ts","src/components/input-radio/controller.ts"],"sourcesContent":["import { Generic } from '@a11y-ui/core';\r\n\r\nimport { watchBoolean } from '../../utils/prop.validators';\r\n\r\n/* types */\r\n/** de\r\n * Macht das Eingabeelement zu einem Pflichtfeld.\r\n */\r\n/** en\r\n * Makes the input element required.\r\n */\r\nexport type PropRequired = {\r\n\trequired: boolean;\r\n};\r\n\r\n/* validator */\r\nexport const validateRequired = (component: Generic.Element.Component, value?: boolean): void => {\r\n\twatchBoolean(component, '_required', value);\r\n};\r\n","import { Generic } from '@a11y-ui/core';\r\n\r\nimport { Stringified } from '../../types/common';\r\nimport { Optgroup, Option, SelectOption } from '../../types/input/types';\r\nimport { Orientation } from '../../types/orientation';\r\nimport { PropLabelWithExpertSlot } from '../../types/props/label';\r\nimport { validateRequired } from '../../types/props/required';\r\nimport { W3CInputValue } from '../../types/w3c';\r\nimport { mapString2Unknown, setState, watchJsonArrayString, watchValidator } from '../../utils/prop.validators';\r\nimport { STATE_CHANGE_EVENT } from '../../utils/validator';\r\nimport { InputController } from '../@deprecated/input/controller';\r\nimport { Props, Watches } from './types';\r\n\r\nexport const fillKeyOptionMap = <T>(keyOptionMap: Map<string, Option<T>>, options: SelectOption<T>[], preKey = ''): void => {\r\n\toptions.forEach((option, index) => {\r\n\t\tconst key = `${preKey}-${index}`;\r\n\t\tif (typeof option === 'object' && option !== null && typeof option.label === 'string' && option.label.length > 0) {\r\n\t\t\tif (Array.isArray((option as Optgroup<T>).options)) {\r\n\t\t\t\tfillKeyOptionMap(keyOptionMap, (option as Optgroup<T>).options, key);\r\n\t\t\t} else {\r\n\t\t\t\tkeyOptionMap.set(key, option as Option<T>);\r\n\t\t\t}\r\n\t\t}\r\n\t});\r\n};\r\n\r\ntype RequiredProps = PropLabelWithExpertSlot;\r\ntype OptionalProps = {\r\n\trequired: boolean;\r\n};\r\ntype InputCheckboxRadioProps = Generic.Element.Members<RequiredProps, OptionalProps>;\r\ntype InputCheckboxRadioWatches = Generic.Element.Watchers<RequiredProps, OptionalProps>;\r\n\r\nexport class InputCheckboxRadioController extends InputController implements InputCheckboxRadioWatches {\r\n\tprotected readonly component: Generic.Element.Component & InputCheckboxRadioProps;\r\n\r\n\tpublic constructor(component: Generic.Element.Component & InputCheckboxRadioProps, name: string, host?: HTMLElement) {\r\n\t\tsuper(component, name, host);\r\n\t\tthis.component = component;\r\n\t}\r\n\r\n\tpublic validateRequired(value?: boolean): void {\r\n\t\tvalidateRequired(this.component, value);\r\n\t}\r\n\r\n\tpublic componentWillLoad(): void {\r\n\t\tsuper.componentWillLoad();\r\n\t\tthis.validateRequired(this.component._required);\r\n\t}\r\n}\r\n\r\nexport class InputRadioController extends InputCheckboxRadioController implements Watches {\r\n\tprotected readonly component: Generic.Element.Component & Props;\r\n\tprivate onStateChange!: () => void;\r\n\tprivate readonly keyOptionMap = new Map<string, Option<W3CInputValue>>();\r\n\r\n\tpublic constructor(component: Generic.Element.Component & Props, name: string, host?: HTMLElement) {\r\n\t\tsuper(component, name, host);\r\n\t\tthis.component = component;\r\n\t}\r\n\r\n\tpublic readonly getOptionByKey = (key: string): Option<W3CInputValue> | undefined => this.keyOptionMap.get(key);\r\n\r\n\tprivate readonly isValueInOptions = (value: unknown, options: Option<W3CInputValue>[]): boolean => {\r\n\t\treturn options.find((option) => option.value === value) !== undefined;\r\n\t};\r\n\r\n\tprotected readonly beforePatchListValue = (_value: unknown, nextState: Map<string, unknown>): void => {\r\n\t\tconst list = nextState.has('_list') ? nextState.get('_list') : this.component.state._list;\r\n\t\tif (Array.isArray(list) && list.length > 0) {\r\n\t\t\tthis.keyOptionMap.clear();\r\n\t\t\tfillKeyOptionMap(this.keyOptionMap, list as SelectOption<W3CInputValue>[]);\r\n\t\t\tconst value = nextState.has('_value') ? nextState.get('_value') : this.component.state._value;\r\n\t\t\tif (this.isValueInOptions(value, list as Option<W3CInputValue>[]) === false) {\r\n\t\t\t\tconst newValue = (\r\n\t\t\t\t\tlist[0] as {\r\n\t\t\t\t\t\tvalue: string;\r\n\t\t\t\t\t}\r\n\t\t\t\t).value;\r\n\t\t\t\tnextState.set('_value', newValue);\r\n\t\t\t\tthis.onStateChange();\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tpublic validateOrientation(value?: Orientation): void {\r\n\t\twatchValidator(\r\n\t\t\tthis.component,\r\n\t\t\t'_orientation',\r\n\t\t\t(value): boolean => value === 'horizontal' || value === 'vertical',\r\n\t\t\tnew Set(['Orientation {horizontal, vertical}']),\r\n\t\t\tvalue,\r\n\t\t\t{\r\n\t\t\t\tdefaultValue: 'vertical',\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tpublic validateList(value?: Stringified<Option<W3CInputValue>[]>): void {\r\n\t\twatchJsonArrayString(\r\n\t\t\tthis.component,\r\n\t\t\t'_list',\r\n\t\t\t(item: Option<W3CInputValue>) => typeof item === 'object' && item !== null && typeof item.label === 'string' && item.label.length > 0,\r\n\t\t\tvalue,\r\n\t\t\tundefined,\r\n\t\t\t{\r\n\t\t\t\thooks: {\r\n\t\t\t\t\tbeforePatch: this.beforePatchListValue,\r\n\t\t\t\t},\r\n\t\t\t}\r\n\t\t);\r\n\t}\r\n\r\n\tpublic validateValue(value?: Stringified<unknown>): void {\r\n\t\tvalue = mapString2Unknown(value);\r\n\t\tvalue = Array.isArray(value) ? value[0] : value;\r\n\t\tsetState(this.component, '_value', value, {\r\n\t\t\tbeforePatch: this.beforePatchListValue,\r\n\t\t});\r\n\t\tthis.setFormAssociatedValue(this.component._value as string);\r\n\t}\r\n\r\n\tpublic componentWillLoad(onChange?: (event: Event) => void): void {\r\n\t\tsuper.componentWillLoad();\r\n\r\n\t\tthis.onStateChange = () => {\r\n\t\t\tif (typeof onChange === 'function') {\r\n\t\t\t\tconst timeout = setTimeout(() => {\r\n\t\t\t\t\tclearTimeout(timeout);\r\n\t\t\t\t\tonChange(STATE_CHANGE_EVENT);\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tthis.validateOrientation(this.component._orientation);\r\n\t\tthis.validateList(this.component._list);\r\n\t\tthis.validateValue(this.component._value);\r\n\t}\r\n}\r\n"],"mappings":";;;mKAgBO,MAAMA,EAAmB,CAACC,EAAsCC,KACtEC,EAAaF,EAAW,YAAaC,EAAM,E,MCJ/BE,EAAmB,CAAIC,EAAsCC,EAA4BC,EAAS,MAC9GD,EAAQE,SAAQ,CAACC,EAAQC,KACxB,MAAMC,EAAM,GAAGJ,KAAUG,IACzB,UAAWD,IAAW,UAAYA,IAAW,aAAeA,EAAOG,QAAU,UAAYH,EAAOG,MAAMC,OAAS,EAAG,CACjH,GAAIC,MAAMC,QAASN,EAAuBH,SAAU,CACnDF,EAAiBC,EAAeI,EAAuBH,QAASK,E,KAC1D,CACNN,EAAaW,IAAIL,EAAKF,E,KAGvB,E,MAUUQ,UAAqCC,EAGjDC,YAAmBlB,EAAgEmB,EAAcC,GAChGC,MAAMrB,EAAWmB,EAAMC,GACvBE,KAAKtB,UAAYA,C,CAGXD,iBAAiBE,GACvBF,EAAiBuB,KAAKtB,UAAWC,E,CAG3BsB,oBACNF,MAAME,oBACND,KAAKvB,iBAAiBuB,KAAKtB,UAAUwB,U,QAI1BC,UAA6BT,EAKzCE,YAAmBlB,EAA8CmB,EAAcC,GAC9EC,MAAMrB,EAAWmB,EAAMC,GAHPE,KAAAlB,aAAe,IAAIsB,IAOpBJ,KAAAK,eAAkBjB,GAAmDY,KAAKlB,aAAawB,IAAIlB,GAE1FY,KAAAO,iBAAmB,CAAC5B,EAAgBI,IAC7CA,EAAQyB,MAAMtB,GAAWA,EAAOP,QAAUA,MAAW8B,UAG1CT,KAAAU,qBAAuB,CAACC,EAAiBC,KAC3D,MAAMC,EAAOD,EAAUE,IAAI,SAAWF,EAAUN,IAAI,SAAWN,KAAKtB,UAAUqC,MAAMC,MACpF,GAAIzB,MAAMC,QAAQqB,IAASA,EAAKvB,OAAS,EAAG,CAC3CU,KAAKlB,aAAamC,QAClBpC,EAAiBmB,KAAKlB,aAAc+B,GACpC,MAAMlC,EAAQiC,EAAUE,IAAI,UAAYF,EAAUN,IAAI,UAAYN,KAAKtB,UAAUqC,MAAMJ,OACvF,GAAIX,KAAKO,iBAAiB5B,EAAOkC,KAAqC,MAAO,CAC5E,MAAMK,EACLL,EAAK,GAGJlC,MACFiC,EAAUnB,IAAI,SAAUyB,GACxBlB,KAAKmB,e,IAtBPnB,KAAKtB,UAAYA,C,CA2BX0C,oBAAoBzC,GAC1B0C,EACCrB,KAAKtB,UACL,gBACCC,GAAmBA,IAAU,cAAgBA,IAAU,YACxD,IAAI2C,IAAI,CAAC,uCACT3C,EACA,CACC4C,aAAc,Y,CAKVC,aAAa7C,GACnB8C,EACCzB,KAAKtB,UACL,SACCgD,UAAuCA,IAAS,UAAYA,IAAS,aAAeA,EAAKrC,QAAU,UAAYqC,EAAKrC,MAAMC,OAAS,GACpIX,EACA8B,UACA,CACCkB,MAAO,CACNC,YAAa5B,KAAKU,uB,CAMfmB,cAAclD,GACpBA,EAAQmD,EAAkBnD,GAC1BA,EAAQY,MAAMC,QAAQb,GAASA,EAAM,GAAKA,EAC1CoD,EAAS/B,KAAKtB,UAAW,SAAUC,EAAO,CACzCiD,YAAa5B,KAAKU,uBAEnBV,KAAKgC,uBAAuBhC,KAAKtB,UAAUiC,O,CAGrCV,kBAAkBgC,GACxBlC,MAAME,oBAEND,KAAKmB,cAAgB,KACpB,UAAWc,IAAa,WAAY,CACnC,MAAMC,EAAUC,YAAW,KAC1BC,aAAaF,GACbD,EAASI,EAAmB,G,GAK/BrC,KAAKoB,oBAAoBpB,KAAKtB,UAAU4D,cACxCtC,KAAKwB,aAAaxB,KAAKtB,UAAUsC,OACjChB,KAAK6B,cAAc7B,KAAKtB,UAAUiC,O"}